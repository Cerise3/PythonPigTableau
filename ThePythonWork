# converting timestamp to month, day, year, hour, and day of the week

import pandas as pd
from datetime import datetime
import csv
import numpy as np

# u.data, 100k data points from MovieLens website, fields: UserID, MovieID, rating, timestamp
file = 'D://DataScience/DataScience-Python3/ml-100k/u.data'
with open(file, newline='') as data:
    CSVfile = csv.reader(data, delimiter='\t')
    TimeLst = list(CSVfile)
Lst2Array = np.asarray(TimeLst)
TimeStp = Lst2Array[:,3]                #the entire file of timestamps

TS = []
for d in range(len(trial)):
    ts = trial[d]
    intts = int(ts)
    dt = datetime.fromtimestamp(intts)
    stdt = dt.strftime('%Y%m%d%H')      #first output is string: '1997120410'
    y = int(stdt[0:4])                  #first output is integer: 1997
    m = int(stdt[4:6])                  #first output is integer: 12
    d = int(stdt[6:8])                  #first output is integer: 04
    h = int(stdt[8:10])                 #first output is integer: 10
    wd = dt.weekday()                   #first output is integer: 3, which is Thursday 
    TheArray = [int(ts),y,m,d,h,wd]     #output: [881250949, 1997, 12, 4, 10, 3]
    TS.append(TheArray)

