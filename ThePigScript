ratings = LOAD '/user/maria_dev/ml-100k/u.data' AS (userID:int, movieID:int, rating:int, ratingTime:int);
dates = LOAD 'user/maria_dev/ml-100k/u.date' USING PigStorage(',')
	AS (rTime:int, yr:int, mo:int, day:int, hr:int, dw:int);
metadata = LOAD '/user/maria_dev/ml-100k/u.item' USING PigStorage('|')
	AS (mID:int, mTitle:chararray, rDate:chararray);
people = LOAD 'user/maria_dev/ml-100k/u.user' USING PigStorage('|')
	AS (uID:int, age:int, gender:chararray);
//loading files: tab, comma, pipe, and pipe delimited

ratingByMovie = GROUP ratings BY movieID;

//grouping the variable ratings by movieID

avgRatings = FOREACH ratingByMovie GENERATE group AS movieID, AVG(ratings.rating) AS avgRating, COUNT(ratings.rating) AS rCount;

//iterate over ratingByMovie, change name group to movieID, average rating in ratings, and count rating    

TwoAsOne = JOIN metadata BY mID, ratings BY movieID;
ThreeAsOne = JOIN TwoAsOne BY TwoAsOne:ratingTime, 
oneStarData = JOIN oneStar BY movieID, nameLookup BY mID;

//this just joins the two based on the movieID or mID

FaveWorst = ORDER oneStarData BY oneStar::rCount;

//orders oneStarData by the number of ratings

DUMP FaveWorst;

//it printed by least watched first 
